# 环境一览图

```plantuml
@startuml
!include  https://plantuml.s3.cn-north-1.jdcloud-oss.com/C4_Container.puml

Boundary(开发测试网络, 开发测试网络, vlan-1) {
    System(开发环境, 开发环境)
    System(测试环境, 测试环境)
    System(数据存储, 数据存储)
    
    开发环境 -d-> 数据存储
    测试环境 -d-> 数据存储
}

Boundary(生产网络, 生产网络, vlan-2) {
    System(预发环境, 预发环境)
    System(生产环境, 生产环境)
    System(生产数据存储, 数据存储)
    
    预发环境 -d-> 生产数据存储
    生产环境 -d-> 生产数据存储
}

@enduml
```

## 开发测试环境的说明

* 较为经典的网络划分是开发和测试环境为一个2层网络(vlan-1)，生产网络是另一个2层网络(vlan-2)，2层网络的隔离显著降低彼此之间进行干扰的可能
* 开发测试网络和生产网络之间也没有直接可达的网络路由，彼此之间的机器和设备不能互相访问，从而杜绝了开发人员在开发测试环境不小心操作生产环境的可能
* 开发测试环境使用的机器倾向于利旧而不是新采，其底层通过K8S统一管理和调度，通过名称空间的不同来区分是开发还是测试
* 混合部署的理由是开发很少能将资源用满，而且大部分代码在开发时运行在开发者的pc上，而不是环境内，开发环境更多的是开通的中间件
* 在此约定，"-dev"结尾的名称空间是开发，"-test"结尾的名称空间是测试
* 任何名称空间都必须被分配配额，这意味着任何发布的应用都必须声明自己使用的资源
* 开发和测试资源使用的远程存储为一个独立的分布式数据存储，未来有必要时继续将利旧的机器在这个存储中扩容
* <font color=red>该环境承载功能测试但不承载压力测试</font>

## 预发和生产环境的说明

* 预发环境的目标是执行生产前的最终验证，包括数据库的变更、压力测试等，因此资源基本和生产环境1:1建设或最低1:0.5建设